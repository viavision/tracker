/*
* Author: Rafael De Castro
* Author URI: https://via.vision/
* Author- Proof of Code: https://github.com/viavision/tracker/blob/main/script.js
* license: GNU General Public License v3.0
* license URI: https://github.com/viavision/tracker/blob/main/LICENSE
* Version: 2
*/
function defer(e){window.jQuery?e():setTimeout((function(){defer(e)}),50)}function vision(){return JSON.parse(localStorage.getItem("vision"))}window.onload=function(){if(!window.jQuery){var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="http://code.jquery.com/jquery-latest.min.js",e.appendChild(t)}},defer((function(){function e(e,t,n,r){let i=new Date;r?"min"==r?i.setTime(i.getTime()+60*n*1e3):"sec"==r&&i.setTime(i.getTime()+1e3*n):i.setTime(i.getTime()+24*n*60*60*1e3);let o="expires="+i.toUTCString();document.cookie=e+"="+t+";"+o+";path=/"}function t(e){let t=e+"=",n=decodeURIComponent(document.cookie).split(";");for(let e=0;e<n.length;e++){let r=n[e];for(;" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}function n(e){var t=[];for(var n of e)-1===t.indexOf(n)&&t.push(n);return t}let r=(new Date).getTime(),i=new Date,o=i.getUTCFullYear(),u=i.getUTCMonth()+1,a=i.getUTCDate();i=o+"-"+u+"-"+a;let s=(new Date).toLocaleTimeString(),c=i+" "+s,l=jQuery(location).attr("href"),m=window.location.hostname,h=document.referrer;h||(h=l);let d={},f="",p=t("number");function g(){let o=window.innerWidth+" x "+window.innerHeight,u=t("token"),a=t("number");u||(u=i+"-"+s+"|"+Math.floor(5e5*Math.random()),u=btoa(unescape(encodeURIComponent(u))),u=u.replace(/=/g,""),e("token",jQuery.trim(u),10,"min"),e("number","",-1),e("number",1,10,"min"),a=1);let p=t("lead");if(p||(p=u,e("lead",jQuery.trim(p),36500)),d.get=function(e){let t=window.location.search.substring(1).split("&"),n={};for(var r=0;r<t.length;r++){var i=t[r].split("=");n[i[0]]=i[1]}return e&&i[0]==e?i[1]:n}(),d.token=u,d.lead=p,f=t("trace"),f){let e=document.createElement("a");e.href=l,f=f+" > "+e.pathname+e.search+e.hash}else{let e=document.createElement("a");e.href=h,f=e.pathname+e.search+e.hash}e("trace",f,10,"min"),breadCrumbs=n(f.split(" > ")),d.page={number:a,domain:m,dir:l,trace:f,breadCrumbs:breadCrumbs,size:o,referrer:h},d.interest={title:n(titleInterest),read:n(readInterest),select:n(selectInterest)},d.cta=cta,d.form=form[form.length-1],d.timeFrame=((new Date).getTime()-r)/1e3,d.datetime=c,localStorage.setItem("recordObj",""),localStorage.setItem("vision",JSON.stringify(d)),localStorage.setItem("recordObj",JSON.stringify(d))}p?(p=parseInt(p)+1,e("number",p,10,"min")):p="",setTimeout((function(){setInterval((function(){g()}),5e3),jQuery("*").one("mouseover mousedown mousemove touchstart touchmove",(function(){g()})),jQuery("input, textarea, select").on("keyup click",(function(){g()})),jQuery(document).on("keydown",(function(e){13===e.keyCode&&g()})),jQuery(document).on("click",(function(){g()}))}),100),function(){cta=[],jQuery("a, button, .btn, .rev-btn").one("click",(function(){let e="";jQuery(this).text()&&(e={1:jQuery(this).text()},0===jQuery(this).parents("header").length&&0===jQuery(this).parents("nav").length||(e={0:"nav",1:jQuery(this).text()})),jQuery.each(this.attributes,(function(t,n){n.value&&"style"!==n.name&&(e[n.name]=n.value)})),e&&cta.push(e)})),form=[],jQuery("input, textarea, select").on("keyup click",(function(){let e={};jQuery(this).closest("form").find("input").each((function(){e[this.name]=this.value})),form.push(e)}));let e=jQuery("body form input[type=submit], body form button[type=submit]");e.prop("disabled",!1),e.removeAttr("disabled"),e.on("click mouseover hover",(function(){let e={submit:!0};jQuery(this).closest("form").find("input").each((function(){e[this.name]=this.value})),form.push(e)})),titleInterest=[],jQuery("title,h1,h2,h3,h4,h5,h6").each((function(){jQuery(this)[0].tagName.toLowerCase();let e=jQuery(this).text().toString();titleInterest.push(e)})),readInterest=[];let t="";jQuery("p").unbind().one("mouseover mousedown mousemove touchstart touchmove",(function(){t&&(clearTimeout(t),t=null);let e=jQuery(this),n="h1,h2,h3,h4,h5,h6",r="";t=setTimeout((function(){if(r=e.prev(n),r.text()||(r=e.find(n)),r.text()||(r=e.parent().find(n)),r.text()||(r=e.parent().parent().find(n)),r.text()||(r=e.parent().parent().parent().find(n)),r.is(":visible")&&(titleTextR=r.text(),titleTextR)){r[0].tagName.toLowerCase();readInterest.push(titleTextR)}}),1)})),selectInterest=[],jQuery(document).on("selectstart",(function(){let e=setInterval((function(){let t=window.getSelection().toString();t?void 0===selectInterest.find((e=>e.includes(t)))&&t.length?selectInterest.push(t):(clearInterval(e),jQuery(selectInterest).each((function(){this.toString().length<t.length&&t.indexOf(this.toString())>=0&&selectInterest.splice(jQuery.inArray(this.toString(),selectInterest),1)}))):clearInterval(e)}),2e3)}))}()}));
